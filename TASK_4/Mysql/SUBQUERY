SELECT *
FROM (
    SELECT 
        o.order_id,
        c.name,
        (o.quantity * p.price) AS Total_Amount
    FROM Orders o
    JOIN Customers c ON o.customer_id = c.customer_id
    JOIN Products p ON o.product_id = p.product_id
) AS OrderTotals
WHERE Total_Amount = (
    SELECT MAX(o.quantity * p.price)
    FROM Orders o
    JOIN Products p ON o.product_id = p.product_id
);
SELECT name
FROM Customers
WHERE customer_id = (
    SELECT customer_id
    FROM Orders
    GROUP BY customer_id
    ORDER BY COUNT(order_id) DESC
    LIMIT 1
);
